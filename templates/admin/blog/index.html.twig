{% extends 'admin/layout.html.twig' %}

{% block admin_content %}
<div class="admin-header">
    <div>
        <div class="muted" style="margin-bottom:6px">İçerikler</div>
        <div style="display:flex; align-items:center; gap:8px;">
            <a class="muted" href="{{ path('admin_dashboard') }}" style="text-decoration:none;">Dashboard</a>
            <span class="muted">/</span>
            <strong>Bloglar</strong>
        </div>
    </div>
    <div class="toolbar">
        <a class="btn flat" href="{{ path('admin_dashboard') }}">Dashboard</a>
    </div>
  </div>

  <div class="toolbar" style="margin: 0 0 12px 0;">
      <a class="btn" href="{{ path('admin_blog_new') }}">Yeni Ekle</a>
  </div>

  {% for type, messages in app.flashes %}
    {% for message in messages %}
      <div class="alert {{ type }}">{{ message }}</div>
    {% endfor %}
  {% endfor %}

  <div class="card span-12">
    <table id="blog-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Başlık</th>
          <th>Açıklama</th>
          <th>Görsel</th>
          <th>İşlemler</th>
        </tr>
      </thead>
      <tbody>
      {% for blog in blogPosts %}
        <tr>
          <td>{{ blog.id }}</td>
          <td>{{ blog.title }}</td>
          <td>{{ blog.description }}</td>
          <td>
            {% if blog.filePath %}
              <img src="{{ asset(blog.filePath) }}" alt="{{ blog.title }}" style="height:40px;border-radius:6px;" />
              <div class="muted">{{ blog.filePath }}</div>
            {% else %}
              <span class="muted">-</span>
            {% endif %}
          </td>
          <td>
            <a class="btn secondary" href="{{ path('admin_blog_edit', {id: blog.id}) }}">Düzenle</a>
            <form class="inline" action="{{ path('admin_blog_delete', {id: blog.id}) }}" method="post" onsubmit="return confirm('Silmek istediğinize emin misiniz?');">
              <input type="hidden" name="_token" value="{{ csrf_token('delete_blog_' ~ blog.id) }}">
              <button class="btn danger" type="submit">Sil</button>
            </form>
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="5" class="muted">Henüz kayıt yok.</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  {% if totalPages > 1 %}
  <div class="toolbar" style="justify-content: flex-end; margin-top: 12px;">
      <a class="btn flat" href="{{ path('admin_blog_index', {page: 1}) }}" title="İlk">«</a>
      <a class="btn flat" href="{{ path('admin_blog_index', {page: page > 1 ? page - 1 : 1}) }}" title="Önceki">‹</a>
      <span class="badge">Sayfa {{ page }} / {{ totalPages }}</span>
      <a class="btn flat" href="{{ path('admin_blog_index', {page: page < totalPages ? page + 1 : totalPages}) }}" title="Sonraki">›</a>
      <a class="btn flat" href="{{ path('admin_blog_index', {page: totalPages}) }}" title="Son">»</a>
  </div>
  {% endif %}
{% endblock %}


